import numpy as np
import pandas as pd
from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = "all"
Merging Dataframes
emp1= pd.DataFrame({'empid':['E90','E87'],
                   'Name':['Asif','Basit']})
emp1


emp2= pd.DataFrame({'empid':['E22','E74','E90'],
                   'Name':['Minil','Akash','Asif']})
emp2


address= pd.DataFrame({'empid':['E87','E22','E49'], 
                   'City':['Mumbai','Banglore','Pune'] , 
                   'State':['Maharashtra','Karnataka','Maharashtra']})
address
#Concat Dataframes
# Method-1
employees = pd.concat([emp1,emp2])
employees
employees=employees.reset_index(drop=True)
employees
#Concat Dataframe
# Method-2
employees1 = emp1.append(emp2)
employees1
employees1=employees1.reset_index(drop=True)
employees1
employees2= pd.concat([emp1,emp2],ignore_index=True)
employees2
# Check for duplicates after concatenation
duplicates = employees[employees.duplicated()]
duplicates
# Remove duplicates
employees.drop_duplicates(keep='last',inplace=True)
employees
employees.reset_index(drop=True,inplace=True)
employees
employees
address
# Inner Join
inner = pd.merge(employees,address,on='empid')
inner
# Inner Join
inner = pd.merge(employees,address,on='empid',how='inner')
inner
# Left Outer Join
left = pd.merge(employees,address,on='empid',how='left')
left
# Right Outer Join
right = pd.merge(employees,address,on='empid',how='right')
right
employees
address
#Full outer join
full = pd.merge(employees,address,how='outer',on='empid')
full
# Salary Data
sal = pd.DataFrame({'empid':['E87','E22','E74','E90','E49'],
                    'salary':['$10,000','$30,000','$20,000','$60,000','$90,000']})
sal
# Add Salary details ( Merge sal & full dataframes)
employee_details = pd.merge(full,sal,how='inner',on='empid')
employee_details
# Employee experience
exp = pd.DataFrame({'employee_id':['E87','E22','E74','E90','E49'],
                    'experience':['5 years','3 years','7 years','2 years','10 years']})
exp 
# Add employee experinece using merge()
# As column names are different (empid , employee_id) we have to use left_on & right_on parameter
pd.merge(employee_details,exp,left_on=['empid'],right_on=['employee_id'],how='inner')
# Add employee experinece using merge() and drop the duplicate column (employee_id)
pd.merge(employee_details,exp,left_on=['empid'],right_on=['employee_id'],how='inner').drop('employee_id',axis=1)
#Save the dataframe
employee_details=pd.merge(employee_details,exp,
                          left_on=['empid'],
                          right_on=['employee_id'],
                          how='inner').drop('employee_id',axis=1)
employee_details
